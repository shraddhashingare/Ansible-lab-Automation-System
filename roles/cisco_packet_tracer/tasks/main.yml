---
- name: Check if Packet Tracer is already installed
  win_stat:
    path: "{{ app_exe_path }}"
  register: pt_installed

- name: Packet Tracer already installed â€” skipping
  debug:
    msg: "Packet Tracer already installed"
  when: pt_installed.stat.exists

- name: Ensure installer directory exists
  win_file:
    path: "{{ installer_folder }}"
    state: directory
  when: not pt_installed.stat.exists

- name: Download Packet Tracer installer from GitHub Release
  win_get_url:
    url: "{{ installer_url }}"
    dest: "{{ installer_dest }}"
    force: true
  when: not pt_installed.stat.exists

- name: Install Packet Tracer silently
  win_command: '"{{ installer_dest }}" /S'
  when: not pt_installed.stat.exists

- name: Installation completed
  debug:
    msg: "Packet Tracer installed successfully!"
  when: not pt_installed.stat.exists
