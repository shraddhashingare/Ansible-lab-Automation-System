---
- name: Check if StarUML is installed
  win_stat:
    path: "{{ staruml_install_path }}"
  register: su_stat

- name: StarUML already installed — skipping
  debug:
    msg: "StarUML already installed — skipping"
  when: su_stat.stat.exists

- name: Ensure installer folder exists on target PC
  win_file:
    path: "{{ installer_folder }}"
    state: directory
  when: not su_stat.stat.exists

- name: Check if installer already exists on target PC
  win_stat:
    path: "{{ installer_dest }}"
  register: su_installer
  when: not su_stat.stat.exists

- name: Copy installer from controller to target PC
  win_copy:
    src: "{{ installer_src }}"
    dest: "{{ installer_dest }}"
  when:
    - not su_stat.stat.exists
    - not su_installer.stat.exists

- name: Install StarUML silently
  win_command: '"{{ installer_dest }}" /silent'
  when: not su_stat.stat.exists
